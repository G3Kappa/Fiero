:- module(test, []).
:- use_module(input).
:- use_module(data).
:- subscribe(action, [actor_moved]).

test:began :- 
	bind(k, pressed, [_]>>(spawn([npc_rat{}], _))),
	bind(j, pressed, [_]>>(spawn([throwable_bomb{charges:999}], _))),
	bind(h, pressed, [_]>>(spawn([potion_of_healing{}], _)))
	.
test:ended :- unbind(_, _, _).

action:actor_moved(_ { actor: @owner }) :- 
	position(@owner, P),
	(data:anim_id get OldId -> anim:stop(OldId) ; true),
	anim:play(P, [explosion{radius: 1, tint: light_green, repeat: -1}], [Id]),
	data:anim_id set Id.
